# 基于鲁班猫2-Humble，镭神 N10 SLAM添加pixhawk飞控的imu数据

---

## 机载电脑下载MAVROS

修改QGC中参数

- MAV_0_CONFIG：TELLEM1
- MAV_0_MODE：Onboard
- SER_TEL1_BAUD：961200 8N1

鲁班猫通过串口连接TELLEM2  
TELLEM1  5V TX RX CTS RTS GND  
鲁班猫2   5V 5V GND TX RX

安装MAVROS

参考：https://blog.csdn.net/weixin_42037083/article/details/137102858

```bash
sudo apt-get install ros-humble-mavros ros-humble-mavros-extras
```

安装geographiclib

```bash
cd ~
git clone https://github.com/weisama/GeographicLib.git
sudo cp -r ~/GeographicLib /usr/share
```

设置鲁班猫2串口

```bash
sudo nano /boot/uEnv/uEnv.txt
# 取消串口3m0的注释
dtoverlay=/dtb/overlay/rk356x-lubancat-uart3-m1-overlay.dtbo
```

查看串口消息

```bash
sudo dmesg | tail
ls /dev/ttyS*
sudo usermod -aG dialout $USER
sudo chmod 777 /dev/ttyS3
```

修改mavros串口设备和波特率

```bash
sudo nano /opt/ros/humble/share/mavros/launch/px4.launch
```

```xml
<arg name="fcu_url" default="/dev/ttyAMA0:921600" />
```

```bash
ros2 launch mavros px4.launch
ros2 launch mavros px4.launch fcu_url:=/dev/ttyAMA0:921600
ros2 topic list
```

### 检查MAVROS状态

```bash
ros2 topic echo /mavros/state
```

以下需接入GPS  
GPS数据

```bash
ros2 topic echo /mavros/global_position/global
```

本地坐标系，单位米

```bash
ros2 topic echo /mavros/local_position/pose
```

磁罗盘航向角

```bash
ros2 topic echo /mavros/global_position/compass_hdg
```

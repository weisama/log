# 鲁班猫2（LubanCat-2）开发板基础设置  
[官方文档](https://doc.embedfire.com/linux/rk356x/quick_start/zh/latest/index.html)

# SLAM 选型  
[Gitee Wiki](https://gitee.com/gwmunan/ros2/wikis/pages)

---

## 基础配置

### 鲁班猫使用非 SD 卡烧录  
[烧录教程](https://doc.embedfire.com/linux/rk356x/quick_start/zh/latest/quick_start/flash_img/flash_img.html)

### SD卡镜像下载（RK3568，仅 Ubuntu 20，仅支持 ROS2 基础版）  
[百度网盘](https://pan.baidu.com/s/19t8AZV9SYTdjn2uObBiSGA) 提取码：`hslu`

[SDK 构建文档](https://doc.embedfire.com/linux/rk356x/build_and_deploy/zh/latest/building_image/lubancat_sdk/lubancat_chip_sdk.html)

---

## 

> 无法使用Docker容器，原因无法下载ssh

---

## 安装 SDK 构建依赖

```bash
sudo apt install -y \
  git ssh make gcc libssl-dev liblz4-tool u-boot-tools curl expect g++ patchelf chrpath \
  gawk texinfo chrpath diffstat binfmt-support qemu-user-static live-build bison flex \
  fakeroot cmake gcc-multilib g++-multilib unzip device-tree-compiler python3-pip \
  libncurses5-dev python3-pyelftools dpkg-dev
```

### 安装 repo
```bash
mkdir ~/bin
curl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo
chmod a+x ~/bin/repo
echo 'PATH=~/bin:$PATH' >> ~/.bashrc
source ~/.bashrc
repo --version
```

### 获取 SDK 源码
```bash
mkdir ~/LubanCat_SDK
python -V
```

---

## 默认密码

| 用户   | 用户名 | 密码   |
| ------ | ------ | ------ |
| 普通   | cat    | temppwd |
| 管理员 | root   | root   |

### 修改密码为 `123`
```bash
su root
passwd root
passwd cat
```

---

## 网络共享（无 Wi-Fi 模块）

参考：[Ubuntu 共享网络](https://blog.csdn.net/shuimanting520/article/details/125597100)

- 地址：`10.42.0.4`
- 掩码：`24`
- 网关：`10.42.0.1`
- DNS：`10.42.0.1`

> 设置完成后主从均需重启，每次开机主机重新开关有线连接。

---

## 基础连接

```bash
sudo wget http://fishros.com/install -O fishros && . fishros
sudo apt update && sudo apt upgrade
sudo apt install -y gedit git nano ros-foxy-rviz2
```

### SSH 连接

鲁班猫端：
```bash
sudo apt install -y openssh-server
sudo systemctl enable --now ssh
ip a
```

本机端：
```bash
ssh -Y cat@10.42.0.15
```

### 本机免密登录
```bash
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
ssh-copy-id -i ~/.ssh/id_rsa.pub cat@10.42.0.15
```

### X11 转发

鲁班猫：
```bash
sudo apt install -y xauth x11-apps
sudo nano /etc/ssh/sshd_config
```

```text
X11Forwarding yes
X11DisplayOffset 10
X11UseLocalhost no
```

```bash
sudo systemctl restart ssh
```

本机：
```bash
sudo apt install -y xauth
ssh -Y cat@10.42.0.15
echo $DISPLAY
xeyes
```

---

## 清理空间（无 SD 卡仅 7G）

```bash
sudo apt-get purge -y chromium-x11 snapd fonts-noto-cjk ibus-data mesa-vdpau-drivers libqt5webkit5
sudo apt-get autoremove
```

---

## ROS2 分布式通信

> 需 ROS 版本一致，暂放弃。

### 本机测试
```bash
ping 10.42.0.15
```

### 鲁班猫关闭防火墙
```bash
sudo apt install -y ufw
sudo ufw disable
```

### 环境变量

鲁班猫 `~/.bashrc`：
```bash
source ~/slam_ws/install/setup.bash
export ROS_DOMAIN_ID=0
export ROS_IP=10.42.0.15
export ROS_LOCALHOST_ONLY=0
```

本机 `~/.bashrc`：
```bash
source /opt/ros/jazzy/setup.bash
export ROS_DOMAIN_ID=0
export ROS_IP=10.42.0.1
```

### 测试通信

鲁班猫发布：
```bash
ros2 topic pub /test_topic std_msgs/String "data: 'Hello from LubanCat'" --rate 1
```

本机查看：
```bash
ros2 topic list
ros2 topic echo /test_topic
```

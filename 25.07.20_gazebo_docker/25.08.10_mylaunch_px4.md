# 设置功能包launch启动自定义世界和无人机模型
基于美团低空经济挑战赛的仿真环境25.08.09_gazebo_px4  

---

## 构建通信功能包，失败，功能包不兼容humble，解决方法使用mavros通信

```bash
mkdir -p ~/ros2_ws/src/sim_test
cd ~/ros2_ws/src
# 修复后的功能包
git clone -b humble-fixes https://github.com/dronecore/px4_ros_com.git 
git clone -b release/1.13 https://github.com/PX4/px4_ros_com.git 
git clone https://github.com/PX4/px4_msgs.git 
sudo apt install python3-colcon-common-extensions ros-humble-eigen3-cmake-module
pip3 install empy==3.3.4 pyros-genmsg setuptools

cd ~/ros2_ws
colcon build
```

---

## 添加环境变量

```bash
gedit ~/.bashrc
source ~/ros2_ws/install/setup.bash
```

---

## 构建launch启动仿真功能包，失败，编译后无法启动launch.py

```bash
mkdir -p ~/ros2_ws/src/sim_test
cd ~/ros2_ws/src
ros2 pkg create --build-type ament_cmake sim_test --dependencies rclcpp gazebo_ros_pkgs geometry_msgs
cd ~/ros2_ws/src/sim_test
mkdir -p launch models/custom_drone worlds

gedit ~/ros2_ws/src/sim_test/launch/sim_test.launch.py
gedit ~/ros2_ws/src/sim_test/launch/px4_bridge.launch.py

gedit ~/ros2_ws/src/sim_test/models/custom_drone/model.sdf
gedit ~/ros2_ws/src/sim_test/models/custom_drone/model.config
gedit ~/ros2_ws/src/sim_test/worlds/custom.world
gedit ~/ros2_ws/src/sim_test/package.xml
gedit ~/ros2_ws/src/sim_test/CMakeLists.txt
```

---

## 编译运行

```bash
cd ~/ros2_ws
rm -rf build install log
colcon build --symlink-install

ros2 launch sim_test sim_test.launch.py

export GAZEBO_MODEL_PATH=${GAZEBO_MODEL_PATH}:/usr/share/gazebo/models:/usr/share/gazebo-11/models:~/px4_ros_ws/src/sim_test/models
```
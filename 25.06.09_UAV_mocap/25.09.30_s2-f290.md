# 购买配件搭建超维空间同款S2-F290
**飞控默认固件是PX4v1.13.3**

---

## QGC配置

```bash
EKF2_AID_MASK = 0
```
禁用GPS

```bash
CBRK_SUPPLY_CHK = 894281
```
无备用电池允许遥控解锁

```bash
SYS_CTRL_ALLOC = Enable
```
允许控制分配功能

加载超维空间科技m0-f410固件参数  
更新其中PID（MPC_xxx）参数

---

## 机载电脑下载MAVROS

修改QGC中参数

```bash
MAV_1_CONFIG：TELLEM2
MAV_1_MODE：Onboard
SER_TEL2_BAUD：961200 8N1
```

笔记本通过串口连接TELLEM2  
TELLEM2： 5V TX RX CTS RTS GND  
树莓派4b： 5V 5V GND TX RX

### 安装MAVROS

参考：https://blog.csdn.net/weixin_42037083/article/details/137102858

```bash
sudo apt-get install ros-humble-mavros ros-humble-mavros-extras
```

### 安装geographiclib

参考：https://blog.csdn.net/zlm2004/article/details/144935740

```bash
sudo cp -r GeographicLib /usr/share
```

### 查看最新的串口消息

```bash
sudo dmesg | tail
ls /dev/ttyAMA*
sudo usermod -aG dialout $USER
sudo chmod 777 /dev/ttyAMA0
```

### 设置树莓派串口

```bash
sudo nano /boot/firmware/config.txt
```

```bash
# 禁用蓝牙释放 ttyAMA0
dtoverlay=disable-bt
# 启用硬件串口
enable_uart=1
# 修复串口时钟稳定性（树莓派3/4必需）
dtoverlay=miniuart-bt
```

### 修改mavros串口设备和波特率

```bash
sudo nano /opt/ros/humble/share/mavros/launch/px4.launch
```

```xml
<arg name="fcu_url" default="/dev/ttyAMA0:921600" />
```

### 启动MAVROS

```bash
ros2 launch mavros px4.launch
ros2 launch mavros px4.launch fcu_url:=/dev/ttyAMA0:921600
```

### 查看话题列表

```bash
ros2 topic list
```

### 检查MAVROS状态

```bash
ros2 topic echo /mavros/state
```

以下需接入GPS：

```bash
# GPS数据
ros2 topic echo /mavros/global_position/global

# 本地坐标系，单位米
ros2 topic echo /mavros/local_position/pose

# 磁罗盘航向角
ros2 topic echo /mavros/global_position/compass_hdg
```

---

## 机载电脑mavros连接px4后，与机载电脑同wifi的本机QGC远程连接

```bash
sudo nano /opt/ros/humble/share/mavros/launch/px4.launch
```

```xml
<arg name="gcs_url" default="udp://:14509@" />
```

本机打开QGC，添加连接吊载无人机2  
type：UDP  
Port：14509  
Server：10.1.1.117:14509

---

## 云卓h12带屏遥控下载qgc，通过接收器连接飞控

QGC链接：https://pan.baidu.com/s/1Rne8v5KpRZjRkFYz9cPm3A?pwd=cwkj  
提取码：cwkj

```bash
MAV_0_CONFIG：TELLEM1
MAV_0_MODE：Normal
SER_TEL1_BAUD：57600 8N1
```
## ssh远程登录

```bash
ssh -Y wheeltec@192.168.0.100
```

设置X11显示屏幕的编号

```bash
echo $DISPLAY
xhost +local:root
```

进入容器

```bash
ros1_restart
ros1
```

使用树莓派外接屏幕显示

```bash
export DISPLAY=:10.0
export XAUTHORITY=/home/wheeltec/.Xauthority
export LIBGL_ALWAYS_SOFTWARE=1
apt install -y x11-apps
xeyes
```

---

## 进入容器更新软件

```bash
ros1_restart
ros1
sudo wget http://fishros.com/install  -O fishros && . fishros
sudo apt update
sudo apt upgrade
```

设置环境

```bash
gedit /root/.bashrc
export DISPLAY=:10.0
```

---

## 解决报错关键

下载必要的功能包

```bash
sudo apt-get update
sudo apt-get install ros-melodic-hector-geotiff
sudo apt-get install ros-melodic-hector-slam
```

使用hector算法可以成功建图，但仍有错误：

```
[ERROR] [1747215682.768174420]: Transform failed during publishing of map_odom transform: Lookup would require extrapolation into the future.  Requested time 1747215681.825897699 but the latest data is at time 1747215681.327393255, when looking up transform from frame [base_footprint] to frame [odom_combined]
[ERROR] [1747215683.270656485]: Transform failed during publishing of map_odom transform: Lookup would require extrapolation into the future.  Requested time 1747215682.325129249 but the latest data is at time 1747215681.825897699, when looking up transform from frame [base_footprint] to frame [odom_combined]
```

Hector 的 pub_map_odom_transform 参数默认为 true，会尝试发布 map → odom_combined 的坐标变换。  
如果同时有其他节点（如 robot_pose_ekf）也在发布 map → odom_combined 的变换，会导致 多节点争用同一 TF，引发时间戳冲突。

解决方法：禁用Hector 的  pub_map_odom_transform

```bash
gedit /home/wheeltec/wheeltec_robot/src/turn_on_wheeltec_robot/launch/include/algorithm_hector.launch
```

19行后添加禁用 pub_map_odom_transform

```xml
<param name="map_update_angle_thresh" value="0.06" />
<param name="pub_map_odom_transform" value="false" />
```

---

## 选择建图算法

```bash
gedit /home/wheeltec/wheeltec_robot/src/turn_on_wheeltec_robot/launch/mapping.launch
```

gmapping  ->  hector

---

## 选择雷达类型

```bash
gedit /home/wheeltec/wheeltec_robot/src/turn_on_wheeltec_robot/launch/wheeltec_lidar.launch
```

ls_N10P  ->  ls_M10P_uart

---

## 运行建图

```bash
cd /home/wheeltec/wheeltec_robot
source devel/setup.bash
roslaunch turn_on_wheeltec_robot mapping.launch
```
